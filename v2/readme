use a lock to protect the map